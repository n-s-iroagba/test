api-client-config:
  description: "Frontend API client configuration for handling HTTP requests, authentication, and error management"
  
  classes:
    - name: "ApiConfig"
      type: "class"
      description: "Global API configuration manager"
      attributes:
        - name: "baseUrl"
          type: "string"
          visibility: "private"
          defaultValue: "https://api.clubportal.com/v1"
        - name: "timeout"
          type: "number"
          visibility: "private"
          defaultValue: "30000"
        - name: "maxRetries"
          type: "number"
          visibility: "private"
          defaultValue: "3"
        - name: "retryDelay"
          type: "number"
          visibility: "private"
          defaultValue: "1000"
        - name: "rateLimiterEnabled"
          type: "boolean"
          visibility: "private"
          defaultValue: "true"
      methods:
        - name: "getInstance"
          returnType: "ApiConfig"
          visibility: "public"
          static: true
          description: "Singleton instance getter"
        - name: "configure"
          parameters:
            - name: "options"
              type: "ApiConfigurationOptions"
          returnType: "void"
          visibility: "public"
        - name: "getBaseUrl"
          returnType: "string"
          visibility: "public"
        - name: "getRequestConfig"
          parameters:
            - name: "endpoint"
              type: "string"
          returnType: "RequestConfig"
          visibility: "public"

    - name: "ApiClient"
      type: "class"
      description: "Main HTTP client with interceptors and request/response handling"
      attributes:
        - name: "axiosInstance"
          type: "AxiosInstance"
          visibility: "private"
        - name: "authInterceptorId"
          type: "number"
          visibility: "private"
        - name: "errorInterceptorId"
          type: "number"
          visibility: "private"
        - name: "loggingInterceptorId"
          type: "number"
          visibility: "private"
        - name: "pendingRequests"
          type: "Map<string, CancelTokenSource>"
          visibility: "private"
      methods:
        - name: "constructor"
          visibility: "public"
          description: "Initializes axios with interceptors"
        - name: "request"
          parameters:
            - name: "config"
              type: "RequestConfig"
          returnType: "Promise<ApiResponse>"
          visibility: "public"
        - name: "get"
          parameters:
            - name: "url"
              type: "string"
            - name: "config"
              type: "RequestConfig"
              optional: true
          returnType: "Promise<ApiResponse>"
          visibility: "public"
        - name: "post"
          parameters:
            - name: "url"
              type: "string"
            - name: "data"
              type: "any"
            - name: "config"
              type: "RequestConfig"
              optional: true
          returnType: "Promise<ApiResponse>"
          visibility: "public"
        - name: "put"
          parameters: []
          returnType: "Promise<ApiResponse>"
          visibility: "public"
        - name: "delete"
          parameters: []
          returnType: "Promise<ApiResponse>"
          visibility: "public"
        - name: "cancelRequest"
          parameters:
            - name: "requestId"
              type: "string"
          returnType: "void"
          visibility: "public"
        - name: "cancelAllRequests"
          returnType: "void"
          visibility: "public"
        - name: "setupInterceptors"
          returnType: "void"
          visibility: "private"

    - name: "AuthInterceptor"
      type: "class"
      description: "Handles authentication token injection and refresh"
      attributes:
        - name: "tokenRefreshInProgress"
          type: "boolean"
          visibility: "private"
          defaultValue: "false"
        - name: "refreshSubscribers"
          type: "Array<Function>"
          visibility: "private"
          defaultValue: "[]"
      methods:
        - name: "interceptRequest"
          parameters:
            - name: "config"
              type: "AxiosRequestConfig"
          returnType: "AxiosRequestConfig"
          visibility: "public"
        - name: "interceptResponse"
          parameters:
            - name: "response"
              type: "AxiosResponse"
          returnType: "AxiosResponse"
          visibility: "public"
        - name: "handleTokenRefresh"
          returnType: "Promise<void>"
          visibility: "private"
        - name: "addAuthToken"
          parameters:
            - name: "config"
              type: "AxiosRequestConfig"
          returnType: "AxiosRequestConfig"
          visibility: "private"

    - name: "ErrorHandler"
      type: "class"
      description: "Centralized error handling and classification"
      attributes:
        - name: "errorMappings"
          type: "Map<number, ErrorHandlerConfig>"
          visibility: "private"
        - name: "isNetworkError"
          type: "boolean"
          visibility: "private"
          defaultValue: "false"
      methods:
        - name: "handleError"
          parameters:
            - name: "error"
              type: "AxiosError | Error"
          returnType: "ApiError"
          visibility: "public"
        - name: "classifyError"
          parameters:
            - name: "error"
              type: "AxiosError"
          returnType: "ErrorType"
          visibility: "private"
        - name: "shouldRetry"
          parameters:
            - name: "error"
              type: "ApiError"
            - name: "attempt"
              type: "number"
          returnType: "boolean"
          visibility: "public"
        - name: "getErrorMessage"
          parameters:
            - name: "error"
              type: "ApiError"
            - name: "userFriendly"
              type: "boolean"
              defaultValue: "true"
          returnType: "string"
          visibility: "public"

    - name: "RateLimiter"
      type: "class"
      description: "Request rate limiting and queuing"
      attributes:
        - name: "requestsPerMinute"
          type: "number"
          visibility: "private"
          defaultValue: "60"
        - name: "requestQueue"
          type: "Array<QueuedRequest>"
          visibility: "private"
        - name: "requestTimestamps"
          type: "Array<number>"
          visibility: "private"
        - name: "isProcessing"
          type: "boolean"
          visibility: "private"
          defaultValue: "false"
      methods:
        - name: "enqueue"
          parameters:
            - name: "request"
              type: "QueuedRequest"
          returnType: "Promise<any>"
          visibility: "public"
        - name: "processQueue"
          returnType: "void"
          visibility: "private"
        - name: "canMakeRequest"
          returnType: "boolean"
          visibility: "private"
        - name: "clearOldTimestamps"
          returnType: "void"
          visibility: "private"

    - name: "ResponseCache"
      type: "class"
      description: "Caching layer for API responses with TTL"
      attributes:
        - name: "cache"
          type: "Map<string, CacheEntry>"
          visibility: "private"
        - name: "maxSize"
          type: "number"
          visibility: "private"
          defaultValue: "100"
        - name: "defaultTTL"
          type: "number"
          visibility: "private"
          defaultValue: "300000"
      methods:
        - name: "get"
          parameters:
            - name: "key"
              type: "string"
          returnType: "any"
          visibility: "public"
        - name: "set"
          parameters:
            - name: "key"
              type: "string"
            - name: "value"
              type: "any"
            - name: "ttl"
              type: "number"
              optional: true
          returnType: "void"
          visibility: "public"
        - name: "has"
          parameters:
            - name: "key"
              type: "string"
          returnType: "boolean"
          visibility: "public"
        - name: "delete"
          parameters:
            - name: "key"
              type: "string"
          returnType: "void"
          visibility: "public"
        - name: "clear"
          returnType: "void"
          visibility: "public"
        - name: "cleanup"
          returnType: "void"
          visibility: "private"

  interfaces:
    - name: "RequestConfig"
      description: "Configuration for API requests"
      properties:
        - name: "url"
          type: "string"
        - name: "method"
          type: "HttpMethod"
        - name: "headers"
          type: "Record<string, string>"
          optional: true
        - name: "params"
          type: "any"
          optional: true
        - name: "data"
          type: "any"
          optional: true
        - name: "timeout"
          type: "number"
          optional: true
        - name: "retry"
          type: "boolean"
          optional: true
        - name: "cache"
          type: "boolean"
          optional: true
        - name: "cacheKey"
          type: "string"
          optional: true
        - name: "cacheTTL"
          type: "number"
          optional: true

    - name: "ApiResponse"
      description: "Standardized API response format"
      properties:
        - name: "data"
          type: "any"
        - name: "status"
          type: "number"
        - name: "statusText"
          type: "string"
        - name: "headers"
          type: "Record<string, string>"
        - name: "config"
          type: "RequestConfig"
        - name: "requestId"
          type: "string"
        - name: "timestamp"
          type: "string"

    - name: "ApiError"
      description: "Standardized API error format"
      properties:
        - name: "code"
          type: "string"
        - name: "message"
          type: "string"
        - name: "status"
          type: "number"
          optional: true
        - name: "details"
          type: "any"
          optional: true
        - name: "timestamp"
          type: "string"
        - name: "requestId"
          type: "string"
          optional: true
        - name: "retryable"
          type: "boolean"
          optional: true

  enums:
    - name: "HttpMethod"
      values: ["GET", "POST", "PUT", "DELETE", "PATCH", "HEAD", "OPTIONS"]

    - name: "ErrorType"
      values: ["NETWORK", "TIMEOUT", "AUTHENTICATION", "AUTHORIZATION", "VALIDATION", "SERVER", "CLIENT", "UNKNOWN"]

  relationships:
    - type: "composition"
      from: "ApiClient"
      to: "ApiConfig"
      description: "ApiClient composes ApiConfig"
    
    - type: "composition"
      from: "ApiClient"
      to: "AuthInterceptor"
      description: "ApiClient composes AuthInterceptor"
    
    - type: "composition"
      from: "ApiClient"
      to: "ErrorHandler"
      description: "ApiClient composes ErrorHandler"
    
    - type: "aggregation"
      from: "ApiClient"
      to: "RateLimiter"
      description: "ApiClient aggregates RateLimiter"
    
    - type: "aggregation"
      from: "ApiClient"
      to: "ResponseCache"
      description: "ApiClient aggregates ResponseCache"
    
    - type: "dependency"
      from: "AuthInterceptor"
      to: "AuthStore"
      description: "AuthInterceptor depends on AuthStore for tokens"
    
    - type: "dependency"
      from: "ErrorHandler"
      to: "ApiError"
      description: "ErrorHandler creates ApiError instances"